
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sn



df=1368



fig, ((ax1,ax2,ax3,ax4), (ax5,ax6,ax7,ax8),(ax9,ax10,ax11,ax12),(ax13,ax14,ax15,ax16))= plt.subplots(4, 4, sharex='col', sharey='row')

#ticksy13=np.linspace(1,2,9)
#ticksy9=np.linspace(2.1,3,9)
#ticksy5=np.linspace(3.1,4,9)
#ticksy1=np.linspace(4.1,5,9)
#ticksx13=np.linspace(8,9,9)
#ticksx14=np.linspace(9.1,10,9)
#ticksx15=np.linspace(10.1,11,9)
#ticksx16=np.linspace(11.1,12,9)

#ax13.set_xticklabels(ticksx13)
#ax14.set_xticklabels(ticksx14)
#ax15.set_xticklabels(ticksx15)
#ax16.set_xticklabels(ticksx16)
#ax13.set_yticklabels(ticksy13)
#ax9.set_yticklabels(ticksy9)
#ax5.set_yticklabels(ticksy5)
#ax1.set_yticklabels(ticksy1)

#ax13.axes.get_xaxis().set_visible(False)
#fig.text(0.5, 0.04, '$\log (M/M_{\odot})$', ha='center', va='center')
#fig.text(0.06, 0.5, '$g-r$', ha='center', va='center', rotation='vertical')
#ax13.text(0.05, 0.004, '$8<\log (M/M_{\odot})<9$', ha='center', va='center')
ax13.axes.get_xaxis().set_ticks([])
ax14.axes.get_xaxis().set_ticks([])
ax15.axes.get_xaxis().set_ticks([])
ax16.axes.get_xaxis().set_ticks([])
ax13.axes.get_yaxis().set_ticks([])
ax9.axes.get_yaxis().set_ticks([])
ax5.axes.get_yaxis().set_ticks([])
ax1.axes.get_yaxis().set_ticks([])
ax13.set_xlabel('$8<\log (M/M_{\odot})<9$')
ax14.set_xlabel('$9<\log (M/M_{\odot})<10$')
ax15.set_xlabel('$10<\log (M/M_{\odot})<11$')
ax16.set_xlabel('$11<\log (M/M_{\odot})<12$')
ax13.set_ylabel('$1<g-r<2$')
ax9.set_ylabel('$2<g-r<3$')
ax5.set_ylabel('$3<g-r<4$')
ax1.set_ylabel('$4<g-r<5$')



chi_sfh1=np.array([3337.5338616435602,482.32851460998756,1665.5876806016786,1031.6177142692582,1142.4705146765598,759.66900297487359,1260.2054019795296,
1535.6552639346291,3085.8014371812692,581.45847757945364,1421.5321717656993,2682.0681723747739,1976.5406738256913,1579.4350420199719,3542.1520906793471,1350.7002407837742,
1205.3242134287375,1540.4932984147561,992.47788832493688,1426.9466770436979,1051.1893073060214,1809.2006293205536,2069.4488702225462,1926.2640431556938,1057.5643715406786,
606.67294110328248,1876.1596351743501,2614.8379825149259,429.4107627057906,4744.5751493440712,1219.8741668464447,1257.7411849072739,1143.6265270554277,2324.9205280500623,
2835.7180221711651,2438.0576446798882,1134.0479971615489,864.21778915149787,407.71110503923455,958.79731534262112,982.18626886218203,510.12548650028867,881.60724246862333,
539.51538245537552,1744.1115969877219,2844.6746355288178,1248.040795460146,701.69854193125911,3629.4242533194829,711.87486283876456,1255.7293461543604,1306.7677556033605,
775.61062946004631,2601.9736624448442,906.73557663111183,654.03315585407063,1610.4628813550621,1028.6293957406469,7096.0466289239948,1008.004686537206,1450.5753716327069,
5620.1545666518177,5279.4287483440394,1123.0323831187904,1076.6617373127262,1536.1679894376657,558.5356214534695,925.91706295879828,2479.6974087151966,3536.8457430330432,
731.48650564743014,4740.7108168141776,1978.7995451555605,614.1875374343291,807.28376595412362,612.5407299331855,1811.4610626328713,2795.8917945571607,580.48101692904152,
5433.7541395662829,2339.4364845925261,3473.6502467993446,815.39502585751165,1374.3488306170473,1765.8749621512288,4424.4733527323742,1472.9931358896677,498.36004942627835,
798.329257797129,2869.226730889377,2687.674411268018,867.84664273107728,3566.5688896878041,3390.1422908711279])


dof1=1888.2123855308007
weights = np.ones_like(chi_sfh1)/float(len(chi_sfh1))
ax8.axvline(x=dof1/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax8.hist(chi_sfh1/df,bins=30, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $3<g-r<4$',cumulative=True)
#ax8.legend(loc='best', frameon=False)
#ax8.set_ylabel('Probability density $\chi ^2$')
#ax8.set_xlabel('$x$')
plt.show()

dof2=964.69528330094988
chi_sfh2=np.array([1381.5121225946773,706.47809362046917,3236.9156513393154,511.57249216369155,426.39060875954334,591.82432349905309,
733.32258746271373,2377.1357343972636,1594.5446822324498,2041.8521631518818,2061.5379745686046,2218.6932677625423,660.67434156008665,
1033.8778391240676,801.52939354590455,835.05197477561126,2345.5853211230196,2907.3431255307028,1012.1953200659856,10578.180631889223,
484.50977646923405,511.19023618800799,783.46380376044044,681.32192120038235,420.44456367651617,1032.2759829311931,147.68816438381032,
596.05635656018956,845.18778557107146,1134.7790044471953,780.01054453217307,277.93359533538762,1248.0663521482147,1131.2770193227493,
1416.5031189812803,343.00395963230653,1404.7456369754198,640.51876878937878,300.89268466933157,326.63804594879582,555.89329357463885,
1234.2768268081322,287.97451286764118,745.43835764235052,4752.7441234022281,887.66512118798448,1083.0086707472881,825.85821163841217,
825.99698656724865,882.44417224974882,2980.3220635838907,1090.5167547901212,3404.9120231924026,759.58054875082485,1645.3182052027078,
395.25179406925514,768.84561590767237,1283.3197233327905,677.54969483700268,1516.1620680616993,2904.5770664859633,677.37882583890359,
492.32715073986867,3816.5642918573562,651.35511342886241])

weights = np.ones_like(chi_sfh2)/float(len(chi_sfh2))
ax12.axvline(x=dof2/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax12.hist(chi_sfh2/df,bins=30, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

dof3=1104.7747194139226
chi_sfh3=np.array([1606.9905047423656,1178.5242856122097,844.51447527036623,711.80202671126574,571.40591313717778,914.77256010030146,
250.75376679608681,315.23482588599967,3885.0959829745429,2254.0395467089406,799.70556773379599,2180.0159454836926,1843.0874877664567,
822.97951604021193,265.52059810138906,297.07942916209117,766.47342705889571,1899.8640333375133,387.9778117934905,1773.5168553321578,
480.80792417678316,539.75778477550523,1256.9019718434627,438.59937127693973,1602.3900820984384,991.53901508915101,321.61274723238915])
weights = np.ones_like(chi_sfh3)/float(len(chi_sfh3))
ax16.axvline(x=dof3/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax16.hist(chi_sfh3/df,bins=20, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()


dof4=1195.9501338148912
chi_sfh4=np.array([987.70656759827409,701.34150243154431,389.49233343926437,98.575210745184833,223.61116743822788,281.33117087370999,509.34447514571258,
551.52259827133355,552.57815793380212,600.36053156113508,648.15015361698931,455.67490516288251,701.18885833398713,625.5387511745497,1165.4132015895016,
1723.4834391709721,483.5281504065652,2285.7749545137472,952.47412815591667,208.14802087058862,628.27879499637038,687.08023339503325,1906.8307791929012,
1241.1338465998351,3143.5889856780955,482.64935266456132,710.65150030346979,1225.0045247087303,4662.4964099949775,1496.0706655456122,576.67822955364454,
282.68167988269278,551.35438240395013,440.17937628074401,294.70734581518246,664.85928105609571,2276.0876847571785,111.42045062684967,2906.1443543091086,
3423.6716289107835,499.79682963358186,411.56041474956379,582.19511876668082,233.53703564678767,884.25571754550697,751.65513050897448,4186.2793067272314,
1929.9291099582674,239.08941419645308,321.56077984788857,907.29977202874079,176.84766623361691,586.59105518578167,3224.3537301483607,213.98408701908781,
173.12580470081946,1079.8251650801674,384.45707404352095,1754.9402190141755,633.81333074988447,716.40343228326503,655.88097121835256,165.10963901712532,
218.82204100887481,55.67548717020128,2640.7642065544765,329.34000024295898,811.89414524051665,1675.0500206655211,462.49066293881873,1664.6401571722347,
1925.9187596495317,288.51447214681303,309.02001337988446,735.27344451990791,392.52432582560863,2725.6153028996869,494.59395899001044,373.45374223565301,
537.59186814080692,242.52445296793783,1526.5797039649121,955.21932151451244,291.2583498350333,878.05631588094207,899.60389348121271,765.0617841438941,
318.69583094051359,263.37372267650841,699.19362431267734,848.02014698106575,344.00889345526502,371.05976015502722,1213.1301317327025,202.71807413198295,
885.85921503036502,484.35142019016308,909.80209146235961,931.8525855045782,874.59417477021873,362.17061005862666,913.25046449622891,865.51542078087584,
280.617082100446,743.32661321620458,1030.3994625248936,905.12273988768015,1869.2606235098181,531.59404008710226,1052.3396438960956,2183.6929730521229,
1034.9566247792231,1247.8185322479417,1573.7435963632029])
weights = np.ones_like(chi_sfh4)/float(len(chi_sfh4))
ax15.axvline(x=dof4/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax15.hist(chi_sfh4/df,bins=30, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

dof5=2425.8341406479144
chi_sfh5=np.array([518.23320605597269,775.42454165096865,175.42233801744715,485.5576671742275,1629.5323282753611,283.9126516113609,814.41090981429045,
165.22467431517347,159.66628653501402,368.43811731290344,141.47940916175747,605.80524098197668,209.04329330142915,2395.7065447349742,1253.9350023200884,
587.97654206931099,1837.4255650609778,1243.5314127974673,205.47132158166244,731.75468098928729,202.33303929343157,76.357960788649507,337.54634839859676,
316.87008315623433,2700.7387376397783,384.59652165283882,170.51205679275984,528.92193081625237,959.08874048901112, 658.83308502060675,341.55862018393941,
154.16507356141864,898.89502754773127,143.99734289519276,204.50307805840572,246.59030134299147,560.5527451300951,564.20192140760287,303.1472880528753,
214.08985964465097,413.39947952518202,429.11531491931021,573.55761020061777,412.26104386343536,327.25119698139616,500.71117276983301,162.05337939655701,
469.90049695104534,467.71134636167864,621.57787034963303,279.5984581515097,582.13804857369735,160.15184208040873,424.04054076763748,572.35745754056632,
109.4143635242287,426.27525878425104,405.40503910913156,364.35315472361015,253.6359815566112,280.4431300801574,536.92257175857503])

weights = np.ones_like(chi_sfh5)/float(len(chi_sfh5))
ax14.axvline(x=dof5/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax14.hist(chi_sfh5/df,bins=30, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

#dof6=1833.5105134830292
#chi_sfh6=np.array([1439.1873977893379,3047.2940747101552,774.67561500830425,897.71091148083065, 517.56654522371889])
#weights = np.ones_like(chi_sfh6)/float(len(chi_sfh6))
#ax13.axvline(x=dof6/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
#ax13.hist(chi_sfh6/df,bins=5, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$')
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
#plt.show()

dof7=2994.064331454349
chi_sfh7=np.array([6554.4632793743131,1284.219024060897, 1856.8665038967686,636.96296298623577,1299.1325002105134,1580.7576903573281,
1662.9082881504246,1566.1409534301167,2270.3959853582628,2389.1803615714607,5410.8247268641353,1026.5255617672915,1255.2092589556105,
10926.840451035703,2295.0780400285389,1751.509362622402,24322.870163261825,1704.1712227013193, 1869.176666350646,2120.5180344505166,
1850.0741454074346,1020.1634825242691,2363.548981012525,1074.1625044190866,2361.6087077846755,2860.3347962972157,5308.8083334279054,
2404.5282521808067,1147.3797887929593,1480.6041039862916,3151.4666209599632,3943.4016736396984,2322.6651376937461,1668.3074034162944,
1388.171704256576,1461.4098965937512,1939.5471309571067,1616.2406232927001,2729.9228647384925,2640.3608235556412,3358.5434609436811,
728.50839049199499,8070.8725079093119,5109.6687217450972,1026.2468328583618,1457.2248604201527,1809.3160632562831,5015.1091396012598,
3322.0647640138723,2333.787989058635,3824.8737727714943,4638.0808883143618,1015.2765572158016,2434.5747736826211,5472.0183578092319,
1437.5049128337555,2903.0658720267484,1284.6521847658066,5320.6706635334922])

weights = np.ones_like(chi_sfh7)/float(len(chi_sfh7))
ax7.axvline(x=dof7/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax7.hist(chi_sfh7/df,bins=30, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

dof8=785.05662972123787
chi_sfh8=np.array([502.5312995308081,580.45729191839803,204.19667370317001,518.27719309677684,1534.8645907539676,1555.9265125639893])
weights = np.ones_like(chi_sfh8)/float(len(chi_sfh8))
ax11.axvline(x=dof8/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax11.hist(chi_sfh8/df,bins=4, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

dof9=1833.5105134830292
chi_sfh9=np.array([1439.1873977893379,3047.2940747101552,774.67561500830425,897.71091148083065, 517.56654522371889])
weights = np.ones_like(chi_sfh9)/float(len(chi_sfh9))
ax13.axvline(x=dof9/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax13.hist(chi_sfh9/df,bins=20, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()

dof10=1422.632610277554
chi_sfh10=np.array([1293.3019087701366,4463.7450753479534,1643.535743085238,2438.2163997960683])
weights = np.ones_like(chi_sfh10)/float(len(chi_sfh10))
ax4.axvline(x=dof10/df,color='k', linestyle='dashed',lw=4, label='UGC11680NED01 $\chi^2$')
ax4.hist(chi_sfh10/df,bins=20, normed=False,weights=weights, histtype='step', lw=3,label='Mass $11<\log (M/M_{\odot})<12$ , color $2<g-r<3$',cumulative=True)
#ax12.legend(loc='best', frameon=False)
#ax12.set_ylabel('Probability density $\chi ^2$')
#ax12.set_xlabel('$x$')
plt.show()
